{
  "comments": [
    {
      "key": {
        "uuid": "fa440f3c_2cb5f314",
        "filename": "libavb/avb_sysdeps.h",
        "patchSetId": 1
      },
      "lineNbr": 52,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-12-16T18:06:04Z",
      "side": 1,
      "message": "Please also remove this stray \";\" as part of the CL!",
      "range": {
        "startLine": 52,
        "startChar": 55,
        "endLine": 52,
        "endChar": 56
      },
      "revId": "6134072682c7782252ddcf2d276354a25faf9109",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fa440f3c_0cb8370e",
        "filename": "libavb/avb_sysdeps.h",
        "patchSetId": 1
      },
      "lineNbr": 62,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-12-16T18:06:04Z",
      "side": 1,
      "message": "Actually I would prefer this to always be 8 since that value will work for both 32- and 64-bit. Any chance you can update the CL to\n\n - change the name to be AVB_ALIGNMENT_SIZE\n - remove the \"Change this to match your architecture - must be a power of two.\" of the comment\n - s/word-alignment/alignment/ in the comment\n - rename avb_assert_word_aligned to avb_assert_aligned",
      "revId": "6134072682c7782252ddcf2d276354a25faf9109",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3a7a2769_f01660bf",
        "filename": "libavb/avb_sysdeps.h",
        "patchSetId": 1
      },
      "lineNbr": 62,
      "author": {
        "id": 1096483
      },
      "writtenOn": "2016-12-16T19:37:04Z",
      "side": 1,
      "message": "Actually AVB_ALIGNMENT_SIZE \u003d 8 does not work for our 32bit bootloader because the bootloader allocate buffer (via avb_alloc) which has  4byte alignment but avb_assert_word_aligned checks 8byte alignment. As result avb_assert is fired.\n\nNote: I added building 32bit version of libavb localy and use it in our bootloader.\n\nMore thoughts:\n - It is not good idea include avb_sysdeps.c by default, because a bootloader, for example, may not have everything. better to have libavb and libavb_posix versions of library\n - better to build both 64bit and 32bit versions, because a lot of bootloaders on devices are built in 32bit mode.\n - also there is a pain between clang and gcc compatibility and I do not know how to solve this. For now I just made local modification in Android.mk to build 32bit version of libavb using gcc instead of clang",
      "parentUuid": "fa440f3c_0cb8370e",
      "revId": "6134072682c7782252ddcf2d276354a25faf9109",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fa440f3c_4f9eb13e",
        "filename": "libavb/avb_sysdeps.h",
        "patchSetId": 1
      },
      "lineNbr": 62,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-12-16T19:52:12Z",
      "side": 1,
      "message": "Right. OK, I think I got confused and thought that AVB_WORD_ALIGNMENT_SIZE had to do with on-disk formats. Sorry about that. So I guess this CL is fine.\n\nMaybe add a comment to avb_alloc() to say that the returned pointer is guaranteed to be aligned to AVB_WORD_ALIGNMENT_SIZE?\n\nAs for 32-bit vs. 64-bit the build system actually produces both versions of the unit test program:\n\n out/host/linux-x86/nativetest64/libavb_host_unittest/libavb_host_unittest\n out/host/linux-x86/nativetest/libavb_host_unittest/libavb_host_unittest\n\nHowever, I\u0027ve only been running one of them (the 64-bit version) and I see it fails on 32-bit ... but only one test: AvbSlotVerifyTest.CorruptedImage\n\nDoes this test pass with your changes? If not, I\u0027ll look into fixing it!",
      "parentUuid": "3a7a2769_f01660bf",
      "revId": "6134072682c7782252ddcf2d276354a25faf9109",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fa440f3c_efe03db3",
        "filename": "libavb/avb_sysdeps.h",
        "patchSetId": 1
      },
      "lineNbr": 62,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-12-16T20:16:31Z",
      "side": 1,
      "message": "I\u0027ve got a fix for AvbSlotVerifyTest.CorruptedImage (it wasn\u0027t fixed with your changes). Stay tuned.",
      "parentUuid": "fa440f3c_4f9eb13e",
      "revId": "6134072682c7782252ddcf2d276354a25faf9109",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "17c45e28_0dddd1fb",
        "filename": "libavb/avb_sysdeps.h",
        "patchSetId": 1
      },
      "lineNbr": 62,
      "author": {
        "id": 1076971
      },
      "writtenOn": "2016-12-19T22:09:53Z",
      "side": 1,
      "message": "Ping about an updated CL? Thanks!",
      "parentUuid": "fa440f3c_efe03db3",
      "revId": "6134072682c7782252ddcf2d276354a25faf9109",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}